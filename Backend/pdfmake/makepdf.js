// playground requires you to assign document definition to a variable called dd

var tableData = [
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    ['1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'],
    // ['1', '01/01/2024', '01/02/2024', 'ABC123', 'CH001', '100', '90', '10', 'Location1', 'Location2', '5', '500', '50', '50', '0', '550'],
    // ['2', '02/01/2024', '02/02/2024', 'XYZ456', 'CH002', '120', '110', '10', 'Location2', 'Location3', '6', '600', '60', '60', '0', '660'],
    // ['3', '03/01/2024', '03/02/2024', 'PQR789', 'CH003', '80', '70', '10', 'Location3', 'Location4', '7', '700', '70', '70', '0', '770'],
    // ['4', '04/01/2024', '04/02/2024', 'LMN456', 'CH004', '150', '140', '10', 'Location4', 'Location5', '8', '800', '80', '80', '0', '880'],
    // ['5', '05/01/2024', '05/02/2024', 'JKL789', 'CH005', '110', '100', '10', 'Location5', 'Location6', '9', '900', '90', '90', '0', '990'],
    // ['6', '06/01/2024', '06/02/2024', 'DEF123', 'CH006', '95', '85', '10', 'Location6', 'Location7', '10', '1000', '100', '100', '0', '1100'],
    // ['7', '07/01/2024', '07/02/2024', 'GHI456', 'CH007', '120', '110', '10', 'Location7', 'Location8', '11', '1100', '110', '110', '0', '1210'],
    // ['8', '08/01/2024', '08/02/2024', 'ABC789', 'CH008', '85', '75', '10', 'Location8', 'Location9', '12', '1200', '120', '120', '0', '1320'],
    // ['9', '09/01/2024', '09/02/2024', 'XYZ123', 'CH009', '130', '120', '10', 'Location9', 'Location10', '13', '1300', '130', '130', '0', '1430'],
    // ['10', '10/01/2024', '10/02/2024', 'PQR456', 'CH010', '105', '95', '10', 'Location10', 'Location11', '14', '1400', '140', '140', '0', '1540'],
    // ['11', '11/01/2024', '11/02/2024', 'LMN789', 'CH011', '75', '65', '10', 'Location11', 'Location12', '15', '1500', '150', '150', '0', '1650'],
    // ['12', '12/01/2024', '12/02/2024', 'JKL123', 'CH012', '140', '130', '10', 'Location12', 'Location13', '16', '1600', '160', '160', '0', '1760'],
    // ['13', '13/01/2024', '13/02/2024', 'DEF456', 'CH013', '90', '80', '10', 'Location13', 'Location14', '17', '1700', '170', '170', '0', '1870'],
    // ['14', '14/01/2024', '14/02/2024', 'GHI789', 'CH014', '125', '115', '10', 'Location14', 'Location15', '18', '1800', '180', '180', '0', '1980'],
    // ['15', '15/01/2024', '15/02/2024', 'ABC123', 'CH015', '100', '90', '10', 'Location15', 'Location16', '19', '1900', '190', '190', '0', '2090'],
    // ['16', '16/01/2024', '16/02/2024', 'XYZ456', 'CH016', '120', '110', '10', 'Location16', 'Location17', '20', '2000', '200', '200', '0', '2200'],
]

var dd = {
    pageOrientation: 'landscape',
    pageSize: 'A4',
	content: [
	    {
	        text: 'RDP Infracon',
	        style: 'header'
	    },
	    '\n',
	    {
	        columns: [
    	        {
    	            width: 90,
    	            text: 'Billing Period',
    	        },
    	        {
    	            text: '01/01/2024 - 15/01/2024'
    	        }
	        ]
	    },
	    {
	        columns: [
    	        {
    	            width: 90,
    	            text: 'SO No.',
    	        },
    	        {
    	            text: 'BR/01'
    	        }
	        ]
	    },
	    {
	        columns: [
    	        {
    	            width: 90,
    	            text: 'Invoice No.',
    	        },
    	        {
    	            text: 'Inv/01'
    	        }
	        ]
	    },
	    {
	        columns: [
    	        {
    	            width: 90,
    	            text: 'Company',
    	        },
    	        {
    	            text: 'Ambuja Cements'
    	        }
	        ]
	    },
	    '\n',
	    {
	        table: {
	            headerRows: 1,
	            body: [
	                [{"text":"Sl No","style":"tableHeader"},{"text":"Loading Date","style":"tableHeader"},{"text":"Unloading Date","style":"tableHeader"},{"text":"Vehicle No","style":"tableHeader"},{"text":"Challan No","style":"tableHeader"},{"text":"Loading Quantity","style":"tableHeader"},{"text":"Unloading Quantity","style":"tableHeader"},{"text":"Billing Quantity","style":"tableHeader"},{"text":"From Location","style":"tableHeader"},{"text":"To Location","style":"tableHeader"},{"text":"Rate","style":"tableHeader"},{"text":"Frieight","style":"tableHeader"},{"text":"SGST","style":"tableHeader"},{"text":"CGST","style":"tableHeader"},{"text":"IGST","style":"tableHeader"},{"text":"Total Amount","style":"tableHeader"}],
	                ...tableData,
	                [
                        { colSpan: 7, border: [false, false, false, false], text: '' }, '', '', '', '', '', '', 
                        'sum: ' + sum(7), 
                        { colSpan: 3, border: [false, false, false, false], text: '' }, '', '', 
                        'sum: ' + sum(11),
                        'sum: ' + sum(12), 
                        'sum: ' + sum(13), 
                        'sum: ' + sum(14), 
                        'sum: ' + sum(15), 
                    ]
	            ]
	        }
	    }
	],
	styles: {
	    header: {
	        bold: true,
	        alignment: 'center'
	    },
	    tableHeader: {
	        bold: true,
	        alignment: 'center'
	    }
	},
	defaultStyle: {
	   // columnGap: 20
	}
}

function sum(col) {
    var sum = 0;
    for (let i = 1; i < tableData.length; i++){
        sum += parseInt(tableData[i][col])
    }
    return sum
}